<% content_for :title, "Tags|Admin" %>

<div class="admin-tags">
  <div class="admin-toolbar">
    <%= link_to "New Tag", new_admin_tag_path, class: "btn btn-primary" %>
  </div>

  <div data-controller="batch-selection">
    <!-- Batch Actions Bar -->
    <div data-batch-selection-target="actions" style="display: none; padding: 10px; background: #f5f5f5; border-radius: 4px; margin-bottom: 10px; gap: 10px;">
      <span style="margin-right: 10px;"><strong><span data-batch-selection-target="count">0</span></strong> selected</span>
      
      <%= form_with url: batch_destroy_admin_tags_path, method: :post, style: "display: inline;" do |f| %>
        <%= f.button "Delete", type: "submit", class: "btn btn-sm", style: "background: #dc3545; color: white;",
            data: { batch_action: "delete" } %>
      <% end %>
    </div>

    <div class="table-container">
      <table class="admin-table compact-table">
        <thead>
          <tr>
            <th style="width: 40px;">
              <input type="checkbox" data-batch-selection-target="selectAll" data-action="change->batch-selection#toggleAll">
            </th>
            <th class="col-actions-compact">Actions</th>
            <th class="col-title">Name</th>
            <th class="col-slug">Slug</th>
            <th class="col-compact">Articles</th>
          </tr>
        </thead>
        <tbody>
          <% if @tags.any? %>
            <% @tags.each do |tag| %>
              <tr>
                <td>
                  <input type="checkbox" value="<%= tag.id %>" 
                         data-batch-selection-target="checkbox" 
                         data-action="change->batch-selection#toggle">
                </td>
                <td class="col-actions-compact">
                  <div class="action-buttons">
                    <%= link_to edit_admin_tag_path(tag), class: "action-btn", title: "Edit" do %>
                      <i class="fas fa-edit"></i>
                    <% end %>
                    <%= link_to admin_tag_path(tag), class: "action-btn", title: "Delete",
                          data: { turbo_method: :delete, turbo_confirm: "Are you sure?" } do %>
                      <i class="fas fa-trash-alt"></i>
                    <% end %>
                  </div>
                </td>
                <td class="col-title">
                  <%= link_to tag.name, edit_admin_tag_path(tag), class: "title-link" %>
                </td>
                <td class="col-slug">
                  <small><%= tag.slug %></small>
                </td>
                <td class="col-compact">
                  <%= tag.articles.count %>
                </td>
              </tr>
            <% end %>
          <% else %>
            <tr>
              <td colspan="5" class="no-content-row">
                <p>No tags found.</p>
              </td>
            </tr>
          <% end %>
        </tbody>
      </table>
    </div>
  </div>
</div>

<% content_for :javascript do %>
  <%= render 'admin/shared/batch_form_handler' %>
<% end %>
