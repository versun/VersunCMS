<h3>GitHub Backup Settings</h3>

<div class="field checkbox">
  <%= form.check_box :github_backup_enabled %>
  <%= form.label :github_backup_enabled, "Enable GitHub Backup" %>
</div>

<div class="field">
  <%= form.label :github_repo_url, "GitHub Repository URL" %>
  <%= form.text_field :github_repo_url, placeholder: "https://github.com/username/backup-repo.git" %>
  <small>The GitHub repository URL where backups will be stored</small>
</div>

<div class="field">
  <%= form.label :github_token, "GitHub Personal Access Token" %>
  <%= form.password_field :github_token, placeholder: "ghp_xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx" %>
  <small>
    Create a token at 
    <%= link_to "GitHub Settings", "https://github.com/settings/tokens/new", target: "_blank" %>
    with <code>repo</code> scope
  </small>
</div>

<div class="field">
  <%= form.label :github_backup_branch, "Branch Name" %>
  <%= form.text_field :github_backup_branch, placeholder: "main" %>
  <small>Default: main</small>
</div>

<div class="field">
  <%= form.label :git_user_name, "Git User Name" %>
  <%= form.text_field :git_user_name, placeholder: "VersunCMS" %>
  <small>Name for git commits (default: VersunCMS)</small>
</div>

<div class="field">
  <%= form.label :git_user_email, "Git User Email" %>
  <%= form.email_field :git_user_email, placeholder: "backup@versuncms.local" %>
  <small>Email for git commits (default: backup@versuncms.local)</small>
</div>

<div class="field">
  <%= form.label :github_backup_cron, "Backup Schedule (Cron Format)" %>
  <%= form.text_field :github_backup_cron, placeholder: "0 2 * * * (Daily at 2:00 AM)" %>
  <small>
    Optional. Use cron format: 
    <code>0 2 * * *</code> for daily at 2AM, 
    <code>0 0 * * 0</code> for weekly on Sunday.
    Leave empty to disable automatic backups.
  </small>
</div>

<% if @setting.last_backup_at.present? %>
  <div class="field">
    <strong>Last Backup:</strong> 
    <%= @setting.last_backup_at.in_time_zone(@setting.time_zone || 'UTC').strftime('%Y-%m-%d %H:%M:%S %Z') %>
  </div>
<% end %>

<div class="info-text">
  <strong>Setup Instructions:</strong>
  <ol>
    <li>Create a new GitHub repository for backups, or use an existing one. Make sure it is not empty.</li>
    <li>Generate a Personal Access Token with <code>repo</code> scope</li>
    <li>Fill in the repository URL and token above</li>
    <li>Configure git user settings for commits</li>
    <li>Optionally set up a cron schedule for automatic backups</li>
    <li>Save settings and trigger a manual backup from the Migrate page</li>
  </ol>
</div>
