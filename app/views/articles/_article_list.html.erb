<div class="article-list timeline">
  <% articles.each do |article| %>
    <article class="timeline-item" data-article-id="<%= article.id %>" data-controller="clickable-card" data-action="click->clickable-card#visit keydown.enter->clickable-card#visit keydown.space->clickable-card#visit" data-clickable-card-url-value="<%= article_path(article) %>" tabindex="0" role="link" aria-label="<%= article.title.presence || 'Open article' %>">
      <div class="timeline-marker"></div>
      <div class="timeline-content">
        <div class="timeline-header">
          <div class="timeline-date">
            <time datetime="<%= article.created_at.iso8601 %>">
              <%= article.created_at.strftime("%Y-%m-%d") %>
            </time>
          </div>
          <% if article.tags.any? %>
            <div class="timeline-tags">
              <% article.tags.each do |tag| %>
                <%= link_to "##{tag.name}", tag_path(tag.slug), class: "tag", data: { turbo_frame: "_top" } %>
              <% end %>
            </div>
          <% end %>
        </div>
        <%= turbo_frame_tag "article_#{article.id}", data: { controller: "turbo-frame-loading" } do %>
          <div data-turbo-frame-loading-target="content">
            <% if article.title.present? %>
              <h2 class="post-title">
                <%= link_to article.title, article_path(article), data: { turbo_frame: "article_#{article.id}" } %>
              </h2>
              <div class="loading-spinner" data-turbo-frame-loading-target="spinner" style="display: none; justify-content: left; align-items: left; padding: 20px;">
                <i class="fas fa-spinner fa-spin" style="font-size: 24px; color: #c04000;"></i>
              </div>
              <% if article.description.present? %>
                <div class="post-description">
                  <%= article.description %>
                </div>
              <% else %>
                <div class="post-content">
                  <%= article.html? ? article.rendered_content.to_s.html_safe : article.rendered_content %>
                </div>
              <% end %>
            <% else %>
              <%= render 'articles/source_reference', article: article %>
              <%= link_to article_path(article), class: "post-content-link", data: { turbo_frame: "article_#{article.id}" } do %>
                <% if article.description.present? %>
                  <div class="post-description">
                    <%= article.description %>
                  </div>
                <% else %>
                  <div class="post-content">
                    <%= article.html? ? article.rendered_content.to_s.html_safe : article.rendered_content %>
                  </div>
                <% end %>
              <% end %>
            <% end %>
          </div>
        <% end %>
      </div>
    </article>
  <% end %>
</div>

<div class="pagination">
<%= will_paginate articles %>
</div>
